# Бие даалт – Тайлан

## Machine 11 — <Chemistry, IP:10.10.11.38>

### 1.) nmap-аар зорилтотыг скан хийхэд 2 нээлттэй порт байгааг харуулав.

![alt text](image.png)

### 2.) 22 порт дээр OpenSSH, 5000 порт дээр Werkzeug httpd 3.0.3 Python вэб сервер ажиллаж байна. 5000 порт руу ороход нэвтрэх болон бүртгүүлэх боломжтой CIF Analyzer-ийн веб хуудас харагдана.

![alt text](image-1.png)

### 3.) Бүртгүүлж нэвтэрсний дараа хяналтын самбар руу орно.

![alt text](image-2.png)

### 4.)

![alt text](image-2.png)

### 5.) CIF файлуудыг ашиглан PoC хайхад, GitHub-т “CIF файлыг парслох үед дурын код гүйцэтгэх” эмзэг байдлын зөвлөмж байдаг. Тэнд бид ашиглаж болох PoC жишээтэй.

![alt text](image-3.png)

### 6.) Дараа нь шинээр үүсгэсэн payload-ийг байршуулж хост хийхийн тулд Python вэб серверийг ажиллуулна.

### Payload-ийг kavi.cif нэрээр хадгалаад байршуулах бөгөөд дараа нь файлыг үзэж болно.

![alt text](image-5.png)

![alt text](image-4.png)

### 7.) Файлыг үзмэгц RCE идэвхжиж, сонсогч дээр shell холболт ирнэ.

![alt text](image-6.png)

### 8.)

![alt text](image-7.png)

### 9.)

![alt text](image-8.png)

### 10.) instance лавлахаас database.db файлыг оллоо. Тэнд хэрэглэгчдийн нууц үгийн хэшүүд байна.

![alt text](image-9.png)

### 11.) Эдгээр хэшүүдийг нэг файлд хадгалаад Hashcat ашиглан тайлна.

![alt text](image-10.png)

### 12.) Бид rosa хэрэглэгчийн олж авсан нууц үгээр зорилтот машинд SSH-ээр нэвтэрнэ.

![alt text](image-11.png)

### 13.)SSH сесс дотроос нээлттэй портуудыг шалгахад 8080 порт localhost дээр дотоодоор нээлттэй байгааг харлаа.

![alt text](image-12.png)

### 14.) Бид тэр портыг SSH-ээр дамжуулж (forward хийж), локал машинаасаа хандах боломжтой болгоно.

![alt text](image-13.png)

### 15.) Форвардласан порт дээр Nmap скан ажиллуултал aiohttp-ийн хувилбар илрэв.

![alt text](image-14.png)

### 16.) Энэ эмзэг байдал нь aiohttp статик нөөцийн хүсэлтийг хэрхэн боловсруулдгаас шалтгаалдаг. feroxbuster-оор сайтыг fuzz хийж үзэхэд бүх статик нөөцийг хариуцдаг assets нэртэй хавтас байгааг илрүүллээ.

![alt text](image-15.png)

### 17.) PoC-д байгаа url, payload, file хувьсагчдыг /root/root.txt-д байрлах root flag-ийг уншихаар шинэчилнэ.

![alt text](image-16.png)

### 18.) Дараа нь exploit-ийг шууд ажиллуулна

![alt text](image-17.png)

### 19.) Эцэст нь түлхүүрийг файлд хадгалж, зөвшөөрлийг нь 600 болгож (chmod 600), дараа нь root эрхээр нэвтрэхэд ашиглана.

![alt text](image-18.png)

## Дүгнэлт

### Гүйцэтгэл: Хортой CIF → app shell → database.db-аас хэш авч crack

# Кибер тэсвэртэй байдлын зөвлөмж

### RCE засвартай хувилбар

### PermitRootLogin no, key-т суурилсан нэвтрэлт, ~/.ssh зөв эрх
